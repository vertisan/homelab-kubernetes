image:
  repository: grafana/grafana-enterprise
  tag: 12.2.0-17253726931-ubuntu

podDisruptionBudget:
  maxUnavailable: 50%
  apiVersion: policy/v1

resources:
  requests:
    cpu: 100m
    memory: 192Mi
  # limits:
  #   cpu: 200m
  #   memory: 768Mi

autoscaling:
  enabled: true
  minReplicas: 1
  maxReplicas: 3
  targetCPU: "75"
  targetMemory: "75"

serviceMonitor:
  enabled: true
  labels:
    prometheus.io/monitor: "true"

grafana.ini:
  server:
    root_url: https://grafana.vrsf.in
  feature_toggles:
    provisioning: true
    kubernetesDashboards: true

persistence:
  enabled: true
  storageClassName: csi-nfs
  size: 20Gi
  accessModes:
    - ReadWriteMany

admin:
  existingSecret: grafana-admin-credentials
  userKey: adminUser
  passwordKey: adminPassword

affinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
        - matchExpressions:
            - key: node-role.kubernetes.io/control-plane
              operator: DoesNotExist

topologySpreadConstraints:
  - labelSelector:
      matchLabels:
        app.kubernetes.io/name: grafana
        app.kubernetes.io/instance: grafana
    topologyKey: topology.kubernetes.io/zone
    maxSkew: 1
    whenUnsatisfiable: ScheduleAnyway
  - labelSelector:
      matchLabels:
        app.kubernetes.io/name: grafana
        app.kubernetes.io/instance: grafana
    topologyKey: kubernetes.io/hostname
    maxSkew: 1
    whenUnsatisfiable: ScheduleAnyway
